!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tada=e():t.Tada=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.r(e);var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.init()}return function(t,e,i){e&&n(t.prototype,e),i&&n(t,i)}(t,[{key:"init",value:function(){var t=this;this.observer=new IntersectionObserver(function(e,i){e.forEach(t.execute.bind(t))},{rootMargin:this.config.threshold})}},{key:"add",value:function(t){if("string"==typeof t)for(var e=document.querySelectorAll(t),i=0,n=e.length;i<n;++i)this.observer.observe(e[i]);else this.observer.observe(t)}},{key:"execute",value:function(t){if(t.isIntersecting){var e=t.target,i=e.tagName,n=e.getAttribute(this.config.attribute);"IMG"===i?e.setAttribute("src",n):e.style.backgroundImage="url(".concat(n,")"),e.removeAttribute(this.config.attribute),this.observer.unobserve(e),"function"==typeof this.config.callback&&this.config.callback(e)}}}]),t}();function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.elements=[]}return function(t,e,i){e&&o(t.prototype,e),i&&o(t,i)}(t,[{key:"setup",value:function(t){if(this.initialized)throw new Error('"setup" should be called before other methods.');for(var e in t||{})this.config[e]=t[e]}},{key:"init",value:function(){this.initialized||(this.initialized=!0,this.applyDebounce(),this.calcViewport(),this.calcThreshold(),this.bindEvents())}},{key:"applyDebounce",value:function(){this.run=function(t,e){return e<=0?t:function(){i&&clearTimeout(i),i=setTimeout(t,e)};var i}(this.prepare.bind(this),this.config.delay)}},{key:"calcViewport",value:function(){this.viewportHeight=window.innerHeight||document.documentElement.clientHeight,this.viewportWidth=window.innerWidth||document.documentElement.clientWidth}},{key:"calcThreshold",value:function(){var t=this.config.threshold.toString().trim().match(/^(\d+)\s*(px|%)?$/i);if(!t||!t.length)throw new Error('"threshold" value should be a number or "px" or "%".');var e=t[1];"%"===t[2]?(this.thresholdHeight=Math.floor(this.viewportHeight*e/100),this.thresholdWidth=Math.floor(this.viewportWidth*e/100)):this.thresholdHeight=this.thresholdWidth=e}},{key:"bindEvents",value:function(){window.addEventListener("scroll",this.onScroll.bind(this),!1),window.addEventListener("resize",this.onResize.bind(this),!1)}},{key:"onScroll",value:function(){this.run()}},{key:"onResize",value:function(){this.calcViewport(),this.calcThreshold(),this.run()}},{key:"add",value:function(t){if(this.init(),"string"==typeof t)for(var e=document.querySelectorAll(t),i=0,n=e.length;i<n;++i)this.addElement(e[i]);else this.addElement(t);this.run()}},{key:"addElement",value:function(t){this.elements.indexOf(t)>=0||this.used(t)||this.elements.push(t)}},{key:"used",value:function(t){var e=t.getAttribute(this.config.attribute);if("IMG"===t.tagName){if(t.getAttribute("src")===e)return!0}else if(t.style.backgroundImage==="url(".concat(e,")"))return!0;return!1}},{key:"prepare",value:function(){for(var t=this.elements.slice(),e=0,i=t.length;e<i;++e){var n=t[e];this.valid(n)&&this.show(n)}}},{key:"valid",value:function(t){if(this.hidden(t))return!1;var e=t.getBoundingClientRect(),i=e.top>=-this.thresholdHeight&&e.top<=this.viewportHeight+this.thresholdHeight,n=e.bottom>=-this.thresholdHeight&&e.bottom<=this.viewportHeight+this.thresholdHeight,r=e.left>=-this.thresholdWidth&&e.left<=this.viewportWidth+this.thresholdWidth,o=e.right>=-this.thresholdWidth&&e.right<=this.viewportWidth+this.thresholdWidth;return(i||n)&&(r||o)}},{key:"hidden",value:function(t){return"none"===window.getComputedStyle(t).display}},{key:"show",value:function(t){var e=t.getAttribute(this.config.attribute);"IMG"===t.tagName?t.setAttribute("src",e):t.style.backgroundImage="url(".concat(e,")"),t.removeAttribute(this.config.attribute),this.elements.splice(this.elements.indexOf(t),1),"function"==typeof this.config.callback&&this.config.callback(t)}},{key:"addContainer",value:function(t){var e=this;this.initialized||this.init(),document.querySelectorAll(t).forEach(function(t){t.addEventListener("scroll",e.run)})}}]),t}();function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var u={setup:function(t){this.config=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){c(t,e,i[e])})}return t}({},{attribute:"data-src",delay:50,threshold:"20%"},{config:t}),this.useIntersectionObserver="IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype,this.useIntersectionObserver?this.instance=new r(this.config):this.instance=new s(this.config)},check:function(){this.instance||this.setup()},add:function(t){this.check(),this.instance.add(t)},addContainer:function(t){this.check(),!this.useIntersectionObserver&&this.instance.addContainer(t)},run:function(){this.check(),!this.useIntersectionObserver&&this.instance.run()}};e.default=u}])});